{% if title %}<h2>{{ title }}</h2>{% endif %}
<div class="opgtm-testimonial">
	<div class="row">
		<div class="col-xs-12 col-md-2">
			<div><span class="rating-num	{{ bg_rating }}">{{ average_rating }}</span></div>
			<div class="store-rating-container rating">
				{% for j in 1..5 %}
				{% if average_rating < j %} <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-1x"></i></span> {% else %}
					<span class="fa fa-stack"><i class="fa fa-star fa-stack-1x"></i><i
							class="fa fa-star-o fa-stack-1x"></i></span> {% endif %}
					{% endfor %}
			</div>
			<div class="rs-sum-total">{{ total_testimonial }}</div>
		</div>
		<div class="col-xs-12 col-md-4">
			<div class="row rating-desc">
				<div class="col-xs-12 col-md-12">
					<span class="progress-stars">
						<i class="fa fa-star color-star-percent-5"></i>5
					</span>
					<div class="progress progress-striped">
						<div class="progress-bar progress-bar-success color-5" role="progressbar"
							aria-valuenow="{{ count_rating_5 }}" aria-valuemin="0" aria-valuemax="100"
							style="width: {{ count_rating_5 }}%">
							<span class="sr-only">{{ count_rating_5 }}%</span>
						</div>
					</div>
				</div>
				<div class="col-xs-12 col-md-12">
					<span class="progress-stars">
						<i class="fa fa-star color-star-percent-4"></i>4
					</span>
					<div class="progress">
						<div class="progress-bar progress-bar-success color-4" role="progressbar"
							aria-valuenow="{{ count_rating_4 }}" aria-valuemin="0" aria-valuemax="100"
							style="width: {{ count_rating_4 }}%">
							<span class="sr-only">{{ count_rating_4 }}%</span>
						</div>
					</div>
				</div>
				<div class="col-xs-12 col-md-12">
					<span class="progress-stars">
						<i class="fa fa-star color-star-percent-3"></i>3
					</span>
					<div class="progress">
						<div class="progress-bar progress-bar-info color-3" role="progressbar" aria-valuenow="{{ count_rating_3 }}"
							aria-valuemin="0" aria-valuemax="100" style="width: {{ count_rating_3 }}%">
							<span class="sr-only">{{ count_rating_3 }}%</span>
						</div>
					</div>
				</div>
				<div class="col-xs-12 col-md-12">
					<span class="progress-stars">
						<i class="fa fa-star color-star-percent-2"></i>2
					</span>
					<div class="progress">
						<div class="progress-bar progress-bar-warning color-2" role="progressbar"
							aria-valuenow="{{ count_rating_2 }}" aria-valuemin="0" aria-valuemax="100"
							style="width: {{ count_rating_2 }}%">
							<span class="sr-only">{{ count_rating_2 }}%</span>
						</div>
					</div>
				</div>
				<div class="col-xs-12 col-md-12">
					<span class="progress-stars">
						<i class="fa fa-star color-star-percent-1"></i>1
					</span>
					<div class="progress">
						<div class="progress-bar progress-bar-danger color-1" role="progressbar"
							aria-valuenow="{{ count_rating_1 }}" aria-valuemin="0" aria-valuemax="100"
							style="width: {{ count_rating_1 }}%">
							<span class="sr-only">{{ count_rating_1 }}%</span>
						</div>
					</div>
				</div>
			</div>
			<div class="rating_navigation">
				{% if testimonations and all_testimonial %}
					<a href="{{ link_all_testimonial }}" class="btn btn-primary"><i class="fa fa-comments-o" aria-hidden="true"></i>{{ text_all_testimonial }}</a>
				{% endif %}
				{% if add_testimonial %}
					<a id="add_testimonial" href="#" class="btn btn-primary"><i class="fa fa-pencil"></i> {{ text_add_testimonial }}</a>
				{% endif %}
			</div>
		</div>
		{% if testimonations %}
		<div class="col-xs-12 col-md-6">
			<div class="testimonation swiper-viewport">
				<div id="testimonation{{ module }}" class="swiper-container">
				<div class="testimonial_note" id="testimonial_note"></div>
					<div class="swiper-wrapper">

						{{ design }}

					</div>
				</div>
				{% if viewPagination %}
				<div class="swiper-pagination testimonation{{ module }}"></div>
				{% endif %}
				{% if viewnavigation %}
				<div class="swiper-pager">
					<div class="swiper-button-next"></div>
					<div class="swiper-button-prev"></div>
				</div>
				{% endif %}
			</div>
		</div>
		<script type="text/javascript"><!--
			$('#testimonation{{ module }}').swiper({
				slidesPerView: 1,
				autoHeight: false,
				centeredSlides: true,
				simulateTouch: true,
				paginationClickable: true,
				direction: "{{ direction }}",
				effect: "{{ effect }}",
				enabled: {{ enabled }},
				followFinger: {{ followFinger }},
				longSwipesMs: {{ longSwipesMs }},
				loop: {{ loop }},
				preloadImages: {{ preloadImages }},
				//autoplay: {{ autoplay }},
				pagination: ".testimonation{{ module }}",
				nextButton: ".testimonation .swiper-button-next",
				prevButton: ".testimonation .swiper-button-prev"
			});
		--></script>
		{% endif %}

	</div>
	<div id="testimonial_form" class="testimonial_form">
		<div class="row">
			<div class="col-sm-12">
				<form class="form-horizontal" id="form-testimonial">
				<input type="hidden" name="status_newTestimonial" value="{{ status_newTestimonial }}">
					<h2>{{ text_write }}</h2>
					<div class="form-group required">
						<div class="col-sm-12">
							<label class="control-label" for="input-name">{{ entry_name }}</label>
							<input type="text" name="name" value="{{ customer_name }}" id="input-name" class="form-control" />
						</div>
					</div>
					<div class="form-group">
						<div class="col-sm-12">
							<label class="control-label" for="input-userLink">{{ entry_userLink }}</label>
							<input type="text" name="userLink" value="{{ customer_userLink }}" id="input-userLink" class="form-control" />
						</div>
					</div>
					<div class="form-group required">
						<div class="col-sm-12">
							<label class="control-label" for="input-testimonial">{{ entry_testimonial }}</label>
							<textarea name="text" rows="5" id="input-testimonial" class="form-control"></textarea>
							<div class="help-block">{{ text_note }}</div>
						</div>
					</div>
					<div class="form-group">
						<div class="col-sm-12">
							<label class="control-label">{{ entry_recomended_shop }}</label>
							<select name="recomended_shop" id="input-recomended_shop" class="form-control">
								<option value="1" selected="selected">{{ text_yes }}</option>
								<option value="0">{{ text_no }}</option>
							</select>
						</div>
					</div>
					<div class="form-group required">
						<div class="col-sm-12">
							<label class="control-label">{{ entry_rating }}</label>
							&nbsp;&nbsp;&nbsp; {{ entry_bad }}&nbsp;
							<input type="radio" name="rating" value="1" />
							&nbsp;
							<input type="radio" name="rating" value="2" />
							&nbsp;
							<input type="radio" name="rating" value="3" />
							&nbsp;
							<input type="radio" name="rating" value="4" />
							&nbsp;
							<input type="radio" name="rating" value="5" />
							&nbsp;{{ entry_good }}
						</div>
					</div>
					{{ captcha }}
					<div class="buttons clearfix">
						<div class="pull-right">
							<button type="button" id="button-testimonial" data-loading-text="{{ text_loading }}"
								class="btn btn-primary">{{ button_save }}</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
<script>
	$('#add_testimonial').on('click', function (e) {
		e.preventDefault();

		$('#testimonial_form').toggle('active');
	})
</script>

<script type="text/javascript"><!--

$('#button-testimonial').on('click', function() {
	$.ajax({
		url: 'index.php?route=extension/module/gentestimonials/write',
		type: 'post',
		dataType: 'json',
		data: $("#testimonial_form form").serialize(),
		beforeSend: function() {
			$('#button-testimonial').button('loading');
		},
		complete: function() {
			$('#button-testimonial').button('reset');
		},
		success: function(json) {
			
			$('.alert-dismissible').remove();

			if (json['error']) {
				$('#testimonial_form').after('<div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> ' + json['error'] + '</div>');
			}

			if (json['success']) {
				$('#testimonial_form').after('<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> ' + json['success'] + '</div>');

				$('input[name=\'name\']').val('');
				$('textarea[name=\'text\']').val('');
				$('input[name=\'rating\']:checked').prop('checked', false);
				$('#testimonial_form').hide();
			}
		}
	});
});
--></script>